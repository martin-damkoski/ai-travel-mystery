{% extends "base.html" %}
{% block title %}Игра #{{ game.id }} • AI Travel Mystery{% endblock %}

{% block content %}
<div class="row between">
  <h1>Игра #{{ game.id }}</h1>
  <span class="pill pill-{{ game.status }}">{{ game.status }}</span>
</div>

<div class="grid-2">

  <section class="card">
    <h2>Траги</h2>
    <ul class="ul">
      {% for k, v in clues.items() %}
        <li><strong>{{ k }}:</strong> {{ v }}</li>
      {% endfor %}
    </ul>

    {% if game.status == "active" %}
      <form class="form row gap" method="post" action="{{ url_for('submit_guess', game_id=game.id) }}">
        <input name="guess" placeholder="Внеси град или држава..." />
        <button class="btn btn-primary" type="submit">Провери</button>
      </form>
      <p class="muted small">Можеш да внесеш или град или држава.</p>
    {% else %}
      <div class="alert alert-success">
        Завршено. Точен одговор: <strong>{{ game.target_city }}, {{ game.target_country }}</strong>
      </div>
    {% endif %}
  </section>


  <section class="card">
    <h2>Обиди</h2>

    {% if not guesses %}
      <p class="muted">Сè уште немаш обиди.</p>
    {% else %}
      <ol class="ol">
        {% for g in guesses %}
          <li>
            {{ g.guess_text }}
            {% if g.is_correct %}
              <span class="pill pill-won">точно</span>
            {% else %}
              <span class="pill pill-lost">неточно</span>
            {% endif %}
            <span class="muted small">{{ g.created_at.strftime("%H:%M:%S") }}</span>
          </li>
        {% endfor %}
      </ol>
    {% endif %}

    <hr class="hr" />

    <h3>AI објаснување</h3>

    {% if game.ai_explanation %}
      <div class="prose">{{ game.ai_explanation }}</div>
    {% else %}
      <p class="muted small">Немаш AI објаснување уште.</p>
    {% endif %}

    <form method="post" action="{{ url_for('ai_action') }}">
      <input type="hidden" name="game_id" value="{{ game.id }}" />
      <button class="btn" type="submit">Објасни</button>
    </form>
  </section>
</div>
<img src="https://images.stockcake.com/public/6/b/b/6bb9363f-b555-468f-97cf-30b97a22175f_large/neon-planet-grid-stockcake.jpg" alt="World Map" class="corner-globe"/>

{% endblock %}
